<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Admin-Panel</title>
    <link rel="stylesheet" href="../css/style.scss">
    <link rel="icon" type="image/x-icon" href="../icons/favicon.ico">
</head>
<body>

<nav class="navbar admin">
    <div class="content">
        <button id="backButton" class="back-btn">Zur√ºck</button>

        <div class="selection active" data-tab="fill">F√ºllst√§nde</div>
        <div class="line"></div>
        <div class="selection" data-tab="settings">Einstellungen</div>
    </div>
</nav>


<main class="admin-wrapper">

    <!-- F√ºllst√§nde -->
    <section class="admin-tab active" id="tab-fill">
        <h2>Fl√ºssigkeitsst√§nde</h2>

        <button id="sortToggle" class="sort-btn">üîΩ Sortierung: Absteigend</button>

        <div class="liquid-list" id="liquidList">
            <!-- Dynamisch bef√ºllt -->
        </div>
    </section>

    <!-- Einstellungen -->
    <section class="admin-tab" id="tab-settings">
        <h2>PIN-Einstellungen</h2>

        <div class="pin-settings">
            <label for="newAlcoholPin">Neuer Alkohol-PIN:</label>
            <input type="password" id="newAlcoholPin" maxlength="4" placeholder="****">
            <button id="savePinBtn" class="save-btn">Speichern</button>
        </div>

        <p id="pinStatus" class="status-msg"></p>
    </section>


    <button id="flushButton" class="flush-btn">üíß Alle Pumpen sp√ºlen</button>
</main>

<script src="../js/scripts.js"></script>
<script>
    // === Tab Navigation ===
    document.querySelectorAll(".selection").forEach(sel => {
        sel.addEventListener("click", () => {
            document.querySelectorAll(".selection").forEach(s => s.classList.remove("active"));
            sel.classList.add("active");

            document.querySelectorAll(".admin-tab").forEach(tab => tab.classList.remove("active"));
            document.getElementById("tab-" + sel.dataset.tab).classList.add("active");
        });
    });

    // === Dummy Fl√ºssigkeitsdaten ===
    const liquids = [
        { name: "Wasser", level: 80 },
        { name: "Saft", level: 50 },
        { name: "Rum", level: 20 },
        { name: "Wodka", level: 60 },
        { name: "Cola", level: 90 },
        { name: "Cola", level: 90 },
        { name: "Cola", level: 90 },
        { name: "Cola", level: 90 },
    ];

    const list = document.getElementById("liquidList");
    const sortBtn = document.getElementById("sortToggle");
    let ascending = false; // Start mit absteigender Sortierung (volle Tanks oben)

    // Renderfunktion
    function renderLiquids() {
        list.innerHTML = "";
        const sorted = [...liquids].sort((a, b) =>
            ascending ? a.level - b.level : b.level - a.level
        );

        sorted.forEach(liq => {
            const el = document.createElement("div");
            el.classList.add("liquid-item");
            el.innerHTML = `
      <span class="liquid-name">${liq.name}</span>
      <div class="liquid-bar">
        <div class="fill" style="width:${liq.level}%"></div>
      </div>
      <span class="liquid-percent">${liq.level}%</span>
    `;
            list.appendChild(el);
        });

        // Button-Text aktualisieren
        sortBtn.textContent = ascending
            ? "üîº Sortierung: Aufsteigend"
            : "üîΩ Sortierung: Absteigend";
    }

    // Klick-Handler f√ºr den Sortierbutton
    sortBtn.addEventListener("click", () => {
        ascending = !ascending;
        renderLiquids();
    });

    // Initiales Rendern
    renderLiquids();



    // === Flush button ===
    document.getElementById("flushButton").addEventListener("click", () => {
        alert("Alle Pumpen werden gesp√ºlt...");
        // TODO: Backend-Request hier einf√ºgen (z.B. /api/flush)
    });

    // === PIN √§ndern ===
    document.getElementById("savePinBtn").addEventListener("click", () => {
        const newPin = document.getElementById("newAlcoholPin").value.trim();
        const status = document.getElementById("pinStatus");

        if (newPin.length !== 4 || isNaN(newPin)) {
            status.textContent = "Bitte einen 4-stelligen numerischen PIN eingeben.";
            status.style.color = "#ff6666";
            return;
        }

        const pins = JSON.parse(localStorage.getItem("cocktailPins")) || {};
        pins.alcohol = newPin;
        localStorage.setItem("cocktailPins", JSON.stringify(pins));

        status.textContent = "Neuer Alkohol-PIN gespeichert!";
        status.style.color = "#a678ff";
        document.getElementById("newAlcoholPin").value = "";
    });

    // === Zur√ºck-Button ===
    document.getElementById("backButton").addEventListener("click", () => {
        window.location.href = "index.html"; // zur√ºck zur Hauptseite
    });

</script>
</body>
</html>
